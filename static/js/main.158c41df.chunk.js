(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{50:function(e,t,a){e.exports=a(60)},60:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),i=a(17),l=a(26),u=a(36);function s(e,t){switch(t.type){case"FETCH_CITY_LIST_REQUEST":return{cityList:[],isLoading:!0,error:null};case"FETCH_CITY_LIST_SUCCESS":return{cityList:t.payload,isLoading:!1,error:null};case"FETCH_CITY_LIST_FAILURE":return{cityList:[],isLoading:!1,error:t.payload};default:return e}}function y(e,t){switch(t.type){case"OPEN_MODAL_CITY":return{isModalOpened:!0,cityCurrentWeather:t.payload};case"CLOSE_MODAL_CITY":return{isModalOpened:!1,cityCurrentWeather:null};default:return e}}function E(e,t){switch(t.type){case"FETCH_WEEKLY_WEATHER_LIST_REQUEST":return{cityWeeklyWeather:null,isLoading:!0,error:null};case"FETCH_WEEKLY_WEATHER_LIST_SUCCESS":return{cityWeeklyWeather:t.payload,isLoading:!1,error:null};case"FETCH_WEEKLY_WEATHER_LIST_FAILURE":return{cityWeeklyWeather:null,isLoading:!1,error:t.payload};default:return e}}var m={trackingCities:[524901,578072,5128638],cityListState:{cityList:[],error:null,isLoading:!0},modalState:{isModalOpened:!1,cityCurrentWeather:null},cityWeeklyWeatherState:{cityWeeklyWeather:null,error:null,isLoading:!0}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;return console.log(t.type),Object(u.a)(Object(u.a)({},e),{},{cityListState:s(e.cityListState,t),modalState:y(e.modalState,t),cityWeeklyWeatherState:E(e.cityWeeklyWeatherState,t)})},d=Object(l.b)(p),h=a(31),f=a(91),C=a(97),S=a(90),W=r.a.createContext(),_=a(86),L=function(){return r.a.createElement(C.a,{py:5,width:"300px",align:"center"},r.a.createElement(_.a,null))},g=function(e){return r.a.createElement(C.a,{align:"center"},"\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.error))},T=a(100),v=a(88),b=a(89);function k(e){return Math.round(+e-273.15)}function O(e){return"https://openweathermap.org/img/wn/".concat(e,"@2x.png")}var I=function(e){var t=e.city;return r.a.createElement(T.a,{title:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435",key:"city".concat(t.name),button:!0,onClick:e.clickHandler},r.a.createElement(v.a,null,r.a.createElement("img",{src:O(t.weather[0].icon),alt:t.name})),r.a.createElement(b.a,{primary:"".concat(t.name),secondary:"".concat(k(t.main.temp),"\xb0C")}))},w={openModalCity:function(e){return{type:"OPEN_MODAL_CITY",payload:e}},fetchCityListRequest:function(){return{type:"FETCH_CITY_LIST_REQUEST"}},fetchCityListSuccess:function(e){return{type:"FETCH_CITY_LIST_SUCCESS",payload:e}},fetchCityListFailure:function(e){return{type:"FETCH_CITY_LIST_FAILURE",payload:e}}},x=Object(i.b)((function(e){return{trackingCities:e.trackingCities,cityListState:e.cityListState}}),w)((function(e){var t=Object(n.useContext)(W),a=e.fetchCityListRequest,c=e.fetchCityListSuccess,o=e.fetchCityListFailure,i=e.trackingCities,l=e.openModalCity,u=e.cityListState,s=u.cityList,y=u.isLoading,E=u.error;Object(n.useEffect)((function(){a(),t.getCurrentWeather(i).then((function(e){return c(e)})).catch((function(e){return o(e)}))}),[a,c,o,i,t]);var m,p=function(e){return function(){l(e)}};return m=y?function(){return r.a.createElement(L,null)}:E?function(){return r.a.createElement(g,{error:E})}:function(){return r.a.createElement(S.a,{component:"nav","aria-label":"main mailbox folders"},s.map((function(e){return r.a.createElement(I,{key:"city".concat(e.name),clickHandler:p(e),city:e})})))},r.a.createElement(m,null)})),H=a(98),F=a(96),R=a(101),j=a(94),A=a(93),Y=a(92),M=a(95);function U(e){return e<10?"0".concat(e):e}function D(e){return"".concat(U(e.getDate()),".").concat(U(e.getMonth()+1),".").concat(e.getFullYear())}var K=function(e){var t,a=e.cityWeeklyWeatherState,n=a.cityWeeklyWeather,c=a.isLoading,o=a.error;return t=c?function(){return r.a.createElement(L,null)}:o?function(){return r.a.createElement(g,{error:o})}:function(){return n.map((function(e,t){var a=D(new Date(1e3*e.dt));return 0!==t&&r.a.createElement(C.a,{key:"day_".concat(t),mr:"10px",mt:"13px"},r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},a),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u0414\u043d\u0451\u043c: ".concat(k(e.temp.day),"\xb0C")),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u041d\u043e\u0447\u044c\u044e: ".concat(k(e.temp.night),"\xb0C")),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},e.weather[0].description[0].toUpperCase()+e.weather[0].description.substring(1)))}))},r.a.createElement(C.a,{mt:"15px"},r.a.createElement(h.a,{variant:"body1",component:"p"},"\u0412 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0435 \u0434\u043d\u0438:"),r.a.createElement(C.a,{display:"grid",gridTemplateColumns:"auto auto"},r.a.createElement(t,null)))},P={fetchWeeklyWeatherListRequest:function(){return{type:"FETCH_WEEKLY_WEATHER_LIST_REQUEST"}},fetchWeeklyWeatherListSuccess:function(e){return{type:"FETCH_WEEKLY_WEATHER_LIST_SUCCESS",payload:e}},fetchWeeklyWeatherListFailure:function(e){return{type:"FETCH_WEEKLY_WEATHER_LIST_FAILURE",payload:e}}},N=Object(i.b)((function(e){return{cityWeeklyWeatherState:e.cityWeeklyWeatherState,cityCurrentWeather:e.modalState.cityCurrentWeather}}),P)((function(e){var t,a=Object(n.useContext)(W),c=e.onCloseHandler,o=e.cityWeeklyWeatherState,i=e.cityCurrentWeather,l=e.fetchWeeklyWeatherListRequest,u=e.fetchWeeklyWeatherListSuccess,s=e.fetchWeeklyWeatherListFailure,y=o.cityWeeklyWeather,E=i.coord,m=E.lat,p=E.lon,d=new Date(1e3*i.dt),S=D(d),_=d.getHours();return Object(n.useEffect)((function(){l(),a.getWeeklyWeather(m,p).then((function(e){return u(e.daily)})).catch((function(e){return s(e)}))}),[a,m,p,l,u,s]),i?r.a.createElement(f.a,{maxWidth:"xs",disableGutters:!0},r.a.createElement(R.a,null,r.a.createElement(C.a,{width:"100px",mx:"auto"},r.a.createElement(Y.a,{component:"img",image:O(i.weather[0].icon)})),r.a.createElement(A.a,null,r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u0421\u0435\u0433\u043e\u0434\u043d\u044f, ",S,":"),r.a.createElement(h.a,{gutterBottom:!0,variant:"h4",component:"h2"},i.name),r.a.createElement(h.a,{variant:"body1",component:"p"},k(i.main.temp),"\xb0C"),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u041e\u0449\u0443\u0449\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a ",k(i.main.feels_like),"\xb0C"),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},i.weather[0].description[0].toUpperCase()+i.weather[0].description.substring(1)),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u0412\u0435\u0442\u0435\u0440 ",i.wind.speed," \u043c/\u0441"),r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435 ",(t=i.main.pressure,Math.round(+t/1.33))," \u043c\u0440\u0441"),y&&_>6&&r.a.createElement(h.a,{variant:"body2",color:"textSecondary",component:"p"},"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430 \u043d\u043e\u0447\u044c\u044e: ",k(y[0].temp.night),"\xb0C"),r.a.createElement(K,{cityWeeklyWeatherState:o})),r.a.createElement(j.a,null,r.a.createElement(M.a,{onClick:c,size:"small",color:"primary"},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c")))):r.a.createElement("p",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434")})),q=Object(F.a)((function(){return{modal:{display:"grid",alignItems:"center",justifyContent:"center",overflowY:"auto"}}})),Q={closeModalCity:function(){return{type:"CLOSE_MODAL_CITY"}}},B=Object(i.b)((function(e){return{isModalOpened:e.modalState.isModalOpened}}),Q)((function(e){var t=e.isModalOpened,a=q(),n=function(){e.closeModalCity()};return r.a.createElement(H.a,{className:a.modal,open:t,onClose:n},r.a.createElement("div",null,r.a.createElement(N,{onCloseHandler:n})))})),J=a(30),z=a(40),G=a(42),V=a(41),X=function(e){Object(G.a)(a,e);var t=Object(V.a)(a);function a(){var e;Object(J.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1},e}return Object(z.a)(a,[{key:"render",value:function(){return this.state.hasError?r.a.createElement(g,{error:this.state.hasError}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:e}}}]),a}(r.a.Component),Z=function(){return r.a.createElement(f.a,{my:20,maxWidth:"xs"},r.a.createElement(C.a,{py:5},r.a.createElement(h.a,{align:"center",variant:"h4"},"\u041f\u043e\u0433\u043e\u0434\u0430 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f")),r.a.createElement(X,null,r.a.createElement(x,null)),r.a.createElement(X,null,r.a.createElement(B,null)))},$=function(){return r.a.createElement(Z,null)},ee=Object({NODE_ENV:"production",PUBLIC_URL:"/weather-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_KEY,te=new function e(){var t=this;Object(J.a)(this,e),this._getData=function(e){var a="".concat(t.url).concat("weather","?id=").concat(e,"&appid=").concat(t.apiKey,"&lang=").concat(t.lang);return fetch(a).then((function(e){return e.ok?e.json():new Error(e.status)}))},this.getCurrentWeather=function(e){var a=e.map((function(e){return t._getData(e)}));return Promise.all(a)},this.getWeeklyWeather=function(e,a){var n="".concat(t.url).concat("onecall","?lat=").concat(e,"&lon=").concat(a,"&exclude=").concat("current,minutely,hourly","&appid=").concat(t.apiKey,"&lang=").concat(t.lang);return fetch(n).then((function(e){return e.ok?e.json():new Error(e.status)}))},this.url="https://api.openweathermap.org/data/2.5/",this.apiKey=ee,this.lang="ru"};o.a.render(r.a.createElement(i.a,{store:d},r.a.createElement(X,null,r.a.createElement(W.Provider,{value:te},r.a.createElement($,null)))),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.158c41df.chunk.js.map